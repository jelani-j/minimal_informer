version: 0.2

phases:
  install:
    runtime-versions:
      nodejs: 18
    commands:
      - echo Installing cfn-lint...
      - pip install cfn-lint
      - echo Installing Node.js dependencies...
      - npm install

  build:
    commands:
      - echo Linting CloudFormation template...
      - cfn-lint template.yml
      - cp template.yml output.yml
      - echo Build phase complete
      - echo Zipping file for lambda function
      - zip -r lambda-function.zip .

artifacts:
  files:
    - output.yml  # or just pick any small file
  scard-paths: yes
  secondary-artifacts:
    StaticSite:
      files:
        - website_layout/**/* 
        - images/**/*
        - index.html
      discard-paths: no  # Keep folders for static hosted site
    LambdaZip:
      files:
        - lambda-function.zip
      discard-paths: yes  # Stops from unziping the file 